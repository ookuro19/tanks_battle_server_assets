# 游戏匹配规则

游戏匹配主要是依据匹配码，所选地图和模式进行。

## 1.优先判断匹配码

* 前置步骤均是判断有无匹配码，若匹配码不为零，则按照相应逻辑进入地图，完全以房主为准。其流程图如下图所示。

```flow
st=>start: 开始匹配
e=>end: 结束
input_match_code=>inputoutput: 输入匹配码
cond_match_code=>condition: 匹配码
是否为0?
cond_has_room=>condition: 是否有相
应房间?
op_enter_room=>operation: 进入相应房间
op_create_room=>operation: 创建相应房间
op_not_match_code=>subroutine: 非开黑模式

st->input_match_code->cond_match_code
cond_match_code(no)->cond_has_room(yes)->op_enter_room
cond_has_room(no)->op_create_room->op_enter_room
cond_match_code(yes)->op_not_match_code
op_enter_room->e
```

## 2. 判断地图，模式

* 若匹配码为0，则在后续步骤中，考虑到游戏人数问题，目前匹配规则可能会有两个方案。

### 1. 只判断地图

通过判断地图进入房间后，按照房主的选择确定游戏模式

```flow
e=>end: 结束
op_not_match_code=>subroutine: 非开黑模式
input_map_num=>inputoutput: 输入地图编号
cond_has_room=>condition: 是否有相
应房间?
op_enter_room=>operation: 进入相应房间
op_create_room=>operation: 创建相应房间

op_not_match_code->input_map_num(bottom)->cond_has_room
cond_has_room(yes)->op_enter_room
cond_has_room(no)->op_create_room->op_enter_room
op_enter_room->e
```

### 2. 地图模式均进行判断

同时根据地图号和模式选择进入或创建房间
主要分为3种情况：

1. 严格匹配
2. 优先地图
3. 优先模式

其中，2、3优先单项的方法原理相同

#### 1. 严格匹配

在严格匹配的情况下，流程相对简单，有则进入房间，无则创建房间

```flow
e=>end: 结束
op_not_match_code=>subroutine: 非开黑模式
input_map_num=>inputoutput: 输入地图
编号、模式
cond_has_room=>condition: 是否有相
应房间?
op_enter_room=>operation: 进入相应房间
op_create_room=>operation: 创建相应房间

op_not_match_code->input_map_num(bottom)->cond_has_room
cond_has_room(yes)->op_enter_room
cond_has_room(no)->op_create_room->op_enter_room
op_enter_room->e
```

#### 2. 优先地图号或模式

以优先地图为例，流程图为：

```flow
e=>end: 结束
op_not_match_code=>subroutine: 非开黑模式
input_map_num=>inputoutput: 输入地图
编号、模式
cond_has_room=>condition: 是否有相
应房间?
op_enter_room=>operation: 进入相应房间

cond_has_room_map=>condition: 是否有相同
地图房间
op_enter_room_map=>operation: 进入相同地图的房间

cond_has_room_mode=>condition: 是否有相同
模式房间
op_enter_room_mode=>operation: 进入相同模式的房间
op_create_room=>operation: 创建相应房间


op_not_match_code->input_map_num(bottom)->cond_has_room
cond_has_room(yes,left)->op_enter_room
cond_has_room(no)->cond_has_room_map
cond_has_room_map(yes)->op_enter_room
cond_has_room_map(no)->cond_has_room_mode
cond_has_room_mode(yes)->op_enter_room
cond_has_room_mode(no)->op_create_room->op_enter_room

```

